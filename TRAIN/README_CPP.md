[← Back](../README.md)

![C++ Logo](logoCPP.png)[^1]

[^1]: © 2017 Jeremy Kratz and The Standard C++ Foundation.

# C++

Please see the [train README](README.md) for the general methods and algorithms used for training.

According to Bjarne Stroustrup:

> "C++ is for people who want to use hardware really well and then manage the complexity of doing that through abstraction."

## License

*All trademarks are the property of their respective owners.*

Copyright 2022 Nicolas Chaussé (nicolaschausse@protonmail.com)

    This project is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, version 3 of the License only.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <https://www.gnu.org/licenses/>.

## Build with C++17

The build environment for this project is rather simple, is wholly coded in [GNU Bash](https://www.gnu.org/software/bash) and is made of 10 scripts.

* ***analyze.sh*** analyzes the C++ source file provided with [Cppcheck](http://cppcheck.net) and [clang-tidy](https://clang.llvm.org/extra/clang-tidy).
* ***build.sh*** simply calls *compile.sh* then *analyze.sh* with the C++ source file provided.
* ***compile.sh*** compiles the C++ source file provided with multiple versions of [GNU g++](https://gcc.gnu.org) and [LLVM clang++](https://clang.llvm.org), to help debug complex compilation problems and allow to performance-test multiples compilers.
* ***documentAll.sh*** invokes documenter [Doxygen](https://www.doxygen.nl) with parameter file **Doxyfile**.
* ***executablesDelete.sh*** simply deletes all the executables generated by *compile.sh* and *run.sh*.
* ***executablesList.sh*** simply lists all the executables generated by *compile.sh* and *run.sh*.
* ***flags.sh*** defines in a single file **all** compile, warnings, analyze and tidy flags and is sourced by *analyze.sh*, *compile.sh* and *run.sh*.
* ***formatAll.sh*** *clang-formats* all .cpp and .hpp C++ source files with stype *Mozilla*.
* ***include.sh*** simply defines a few utilities and is sourced by other scripts.
* ***run.sh*** compiles the C++ source file provided with only one compiler then, if no error occurs, runs the corresponding executable.

### Install LLVM Tools and Clang++

Clang and LLVM tools are not installed by default on many platforms, one can install them through the following [APT packages](https://apt.llvm.org). For versions 13, 14 and 15: `clang-<version> clang-format-<version> clang-tidy-<version> clang-tools-<version> llvm-<version> llvm-<version>-tools lld-<version>`.

### Warning Flags

Compilers nowadays provide many useful warnings, that shall be overlooked only very purposefully. The following shall always be enabled in this project:

* `-Wpedantic`, `-Wall`, and `-Wextra`.
* For LLVM: `-Weverything` (plus `-Wno-c++98-compat`, `-Wno-c++11-compat` and `-Wno-c++14-compat'`).

### Compile Flags

For maximum performances when not debugging, the following shall be enabled:

* `-O3`, `-g0` and `-DNDEBUG`.
* `-pedantic-errors`.
* `-march=native` and `-mtune=native`. This implies recompiling on **all** platforms as this may generate executables that are not very portable.
* Disabling link-time optimization with `-fno-lto` will in some conditions increase performances and should be tested.

### Static Code Analysis

[Cppcheck](http://cppcheck.net) comes quite usable as is and the latest version can easily be git-cloned and compiled, and then called with flag `-enable=all`:

```
$ cd <package directory of your choice>
$ git clone https://github.com/danmar/cppcheck.git
$ cd cppcheck
$ export CXX='clang++-14'  # Optional, compiler of your choice.
$ make
$ ./cppcheck --enable=all program.cpp
```

[clang-tidy](https://clang.llvm.org/extra/clang-tidy) needs much more flags, and different versions will sometimes output slightly different results. This is why ***analyze.sh*** above calls two versions of it. This project uses many *groups of checks* including:

* `cert-*` to enforce [CERT Secure Coding Guidelines](https://wiki.sei.cmu.edu/confluence/display/seccode/SEI+CERT+Coding+Standards).
* `clang-analyzer-*` to enable clang's static analyzer checks.
* `concurrency-` to check the multithreading.
* `performance-` to check for performance.

See ***flags.sh*** for more details.